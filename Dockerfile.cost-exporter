FROM python:3.11-slim

RUN pip install --no-cache-dir boto3 prometheus-client

COPY scripts/cost-exporter.py /app/

EXPOSE 9091

HEALTHCHECK --interval=30s --timeout=3s CMD python3 -c "import urllib.request,sys; r=urllib.request.urlopen('http://127.0.0.1:9091/health'); sys.exit(0 if getattr(r, 'status', 200)==200 else 1)"

CMD ["python3", "/app/cost-exporter.py"]
